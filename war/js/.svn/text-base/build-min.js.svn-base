function loadBuildTabs(a){if(a==null){return}currstrategy=a;strategyid=a.strategyid;$("#strategytitle").text(a.strategyname);while($("#buildtabs").tabs("length")>0){$("#buildtabs").tabs("remove",0)}$("#bfollow, #bunfollow, #bwatch, #bunwatch, #bnew").hide();if(userid!=0){$("#bnew").show()}if(a.relation==0){$("#buildtabs").tabs("add","summary.html?strategyid="+currstrategy.strategyid,"Summary");$("#buildtabs").tabs("add","entertrade.html?strategyid="+currstrategy.strategyid,"Enter Signal");$("#buildtabs").tabs("add","recentsignals.html?strategyid="+currstrategy.strategyid,"Recent Signals");$("#buildtabs").tabs("add","closedtrades.html?strategyid="+currstrategy.strategyid,"Closed Trades");$("#buildtabs").tabs("add","portfolio.jsp?strategyid="+currstrategy.strategyid,"Portfolio");$("#buildtabs").tabs("add","performance.jsp?strategyid="+currstrategy.strategyid,"Performance");$("#buildtabs").tabs("add","settings.jsp?strategyid="+currstrategy.strategyid,"Settings")}else{if(a.relation==1){$("#buildtabs").tabs("add","summary.html?strategyid="+currstrategy.strategyid,"Summary");$("#buildtabs").tabs("add","recentsignals.html?strategyid="+currstrategy.strategyid,"Recent Signals");$("#buildtabs").tabs("add","closedtrades.html?strategyid="+currstrategy.strategyid,"Closed Trades");$("#buildtabs").tabs("add","portfolio.jsp?strategyid="+currstrategy.strategyid,"Portfolio");$("#buildtabs").tabs("add","performance.jsp?strategyid="+currstrategy.strategyid,"Performance");$("#bunfollow").show()}else{if(a.relation>1){$("#buildtabs").tabs("add","summary.html?strategyid="+currstrategy.strategyid,"Summary");$("#buildtabs").tabs("add","closedtrades.html?strategyid="+currstrategy.strategyid,"Closed Trades");$("#buildtabs").tabs("add","performance.jsp?strategyid="+currstrategy.strategyid,"Performance");$("#bfollow").show();if(a.relation==2){$("#bunwatch").show()}else{$("#bwatch").show()}}}}$("#buildtabs").tabs("select",0)}$(document).ready(function(){$("#strategymenu").accordion({active:true,alwaysOpen:false,fillSpace:true,collapsible:true});$("#strategymenuResizer").hide();$("#buildtabs").tabs({select:2,ajaxOptions:{error:function(e,b,d,c){$(c.hash).html("Couldn't load this tab. We'll try to fix this as soon as possible. If this wouldn't be a demo.")}}});if(userid!=0){$("#strategymenuResizer").show();if(strategylist==null&&referred==null){$("#buildtabs").tabs("add","strategysetup.jsp","Setup",0)}if(strategylist!=null){for(var a=0;a<strategylist.length;a++){if(strategylist[a].relation==0){$("#mystrategy").append('<li><a href="'+strategylist[a].strategyid+'">'+strategylist[a].strategyname+"</a></li>")}else{if(strategylist[a].relation==1){$("#ifollow").append('<li><a href="'+strategylist[a].strategyid+'">'+strategylist[a].strategyname+"</a></li>")}else{$("#iwatch").append('<li><a href="'+strategylist[a].strategyid+'">'+strategylist[a].strategyname+"</a></li>")}}}}$("#strategymenu div li a").click(function(f){f.preventDefault();var c=$(f.target).attr("href");var b=null;for(var d=0;d<strategylist.length;d++){if(strategylist[d].strategyid==c){b=strategylist[d];break}}$("#strategytitle").text($(f.target).text());loadBuildTabs(b);return false});if(referred!=null){loadBuildTabs(referred)}else{if(strategylist!=null&&strategylist.length!=0){loadBuildTabs(strategylist[0])}}referred=null}else{if(referred!=null){loadBuildTabs(referred);referred=null}else{$("#titleblock").hide();$("#buildtabs").tabs("add","loginform.html","Login/Signup",0)}}$("#bnew").click(function(b){b.preventDefault();while($("#buildtabs").tabs("length")>0){$("#buildtabs").tabs("remove",0)}$("#buildtabs").tabs("add","strategysetup.jsp","Setup")});$("#bfollow, #bunfollow").click(function(b){b.preventDefault();$.ajax({type:"post",url:"handlestrategy",dataType:"json",data:"action="+$(b.target).attr("name")+"&userid="+userid+"&strategyid="+currstrategy.strategyid,error:function(){alert("error occured!!!")},success:function(e){if(e.status=="success"){if(e.action=="follow"){currstrategy.relation=1;$("#ifollow").append('<li><a href="'+currstrategy.strategyid+'">'+currstrategy.strategyname+"</a></li>");$("#strategymenu div li a").click(function(j){j.preventDefault();var g=$(j.target).attr("href");var f=null;for(var h=0;h<strategylist.length;h++){if(strategylist[h].strategyid==g){f=strategylist[h];break}}$("#strategytitle").text($(j.target).text());console.log("Selected strategyid: "+$(j.target).attr("href"));loadBuildTabs(f);return false});console.log('<li><a href="'+currstrategy.strategyid+'">'+currstrategy.strategyname+"</a></li>");strategylist.push(currstrategy);$("#bfollow").hide();$("#bunfollow").show()}else{if(e.action=="unfollow"){currstrategy.relation=9;var d=$('a[href="'+currstrategy.strategyid+'"]').attr("href");var c=0;for(;c<strategylist.length;c++){if(strategylist[c].strategyid==d){break}}strategylist.splice(c,1);$("#bunfollow").hide();$("#bfollow").show();$('a[href="'+currstrategy.strategyid+'"]').remove();console.log('a[href="'+currstrategy.strategyid+'"]')}}}}})})});